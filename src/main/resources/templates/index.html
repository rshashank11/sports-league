<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Sports Leagues</title>
    <th:block th:replace="fragments/fonts :: font-links"></th:block>
    <th:block th:replace="fragments/styles :: style-links"></th:block>
    <link rel="stylesheet" th:href="@{/css/admin.css}">
    <style>
        /* Modal Styles */

    </style>
</head>
<body>

<header th:include="fragments/header :: header"></header>

<div style="margin: 20px auto; text-align: center;">
    <h1>Admin Panel</h1>

    <!-- Search Input and Create Button -->
    <div style="margin-bottom: 20px;">
        <input type="text" placeholder="Search leagues..." style="width: 300px; padding: 10px;">
        <button id="openModalBtn" class="button button-primary">Create a New League</button>
    </div>

    <!-- Modal for League Creation -->
    <div id="createLeagueModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Create a New League</h3>
                <span class="close" id="closeModalBtn">&times;</span>
            </div>
            <form action="/leagues/create" method="post" id="modal-create-league-form" novalidate>
                <input type="text" name="name" id="modal-name" placeholder="League Name" required>
                <span id="modal-nameError" class="error-message"></span>
                <br>
                <textarea name="description" id="modal-description" placeholder="Description" required></textarea>
                <span id="modal-descriptionError" class="error-message"></span>
                <br>
                <input type="datetime-local" name="startDate" id="modal-startDate" required>
                <span id="modal-startDateError" class="error-message"></span>
                <br>
                <input type="datetime-local" name="lastRegistrationDate" id="modal-lastRegistrationDate" required>
                <span id="modal-lastRegistrationDateError" class="error-message"></span>
                <br>
                <input type="text" name="venue" id="modal-venue" placeholder="Venue" required>
                <span id="modal-venueError" class="error-message"></span>
                <br>
                <select name="sports" id="modal-sports" required>
                    <option value="">Select Sport</option>
                    <option th:each="sport : ${sports}" th:value="${sport}" th:text="${sport}"></option>
                </select>
                <span id="modal-sportsError" class="error-message"></span>
                <br><br>
                <div class="modal-footer">
                    <button type="button" id="closeModalBtnFooter" class="button button-danger">Cancel</button>
                    <button type="submit" class="button button-primary">Create</button>
                </div>
            </form>
        </div>
    </div>
</div>

<footer class="footer">
    <p>&copy; 2024 Sports Leagues</p>
</footer>

<script>
    document.addEventListener("DOMContentLoaded", () => {
        // Modal logic
        const modal = document.getElementById("createLeagueModal");
        const openModalBtn = document.getElementById("openModalBtn");
        const closeModalBtns = [document.getElementById("closeModalBtn"), document.getElementById("closeModalBtnFooter")];

        // Open modal
        openModalBtn.addEventListener("click", () => {
            modal.style.display = "block";
        });

        // Close modal
        closeModalBtns.forEach(btn => {
            btn.addEventListener("click", () => {
                modal.style.display = "none";
            });
        });

        // Close modal when clicking outside content
        window.addEventListener("click", (event) => {
            if (event.target === modal) {
                modal.style.display = "none";
            }
        });

        // Client-side validation for the modal form
        const modalForm = document.getElementById("modal-create-league-form");
        const modalFields = ["modal-name", "modal-description", "modal-startDate", "modal-lastRegistrationDate", "modal-venue", "modal-sports"];

        modalForm.addEventListener("submit", (event) => {
            let valid = true;

            modalFields.forEach((field) => {
                const input = document.getElementById(field);
                const error = document.getElementById(`${field}Error`);

                if (!input.value.trim()) {
                    error.textContent = `${field.replace(/modal-/, '').replace(/([A-Z])/g, ' $1')} is required.`;
                    valid = false;
                } else {
                    error.textContent = "";
                }
            });

            if (!valid) {
                event.preventDefault();
            }
        });
    });
</script>

</body>
</html>
